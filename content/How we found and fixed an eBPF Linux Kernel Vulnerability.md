tags: #ebpf #linux #lpe #kernel
original link: [How we found and fixed an eBPF Linux Kernel Vulnerability](https://bughunters.google.com/blog/6303226026131456/a-deep-dive-into-cve-2023-2163-how-we-found-and-fixed-an-ebpf-linux-kernel-vulnerability?ref=blog.exploits.club)
newsletter link: [exploits.club Weekly Newsletter 34 - V8 Confusions, Smart Speaker Spying, Summer Camp Round-Up, And More](https://blog.exploits.club/exploits-club-weekly-newsletter-34-v8-confusions-smart-speaker-spying-summer-camp-round-up-and-more-2/)

---
## Exploits Club Summary:
> The security engineering team at Google released a blog this week detailing how they **found and fixed** [**CVE-2023-2163**](https://github.com/google/security-research/security/advisories/GHSA-j87x-j6mh-mv8v?ref=blog.exploits.club)**, an eBPF verifier bug resulting from incorrect pruning.** The post starts with a bit of context, explaining the **background behind eBPF, and why it has been an attractive target for researchers** (Look no further than [EC 30](https://blog.exploits.club/exploits-club-weekly-newsletter-30/), where we covered [CVE-2024-41003](https://github.com/google/security-research/security/advisories/GHSA-hfqc-63c7-rj9f?ref=blog.exploits.club#event-251168)). The write-up then quickly touches on the creation of [**Buzzer**](https://security.googleblog.com/2023/05/introducing-new-way-to-buzz-for-ebpf.html?ref=blog.exploits.club)**-the-fuzzer**, before taking a look at how eBPF path pruning actually works. This gets us to the team's **RCA of the fuzzer bug, which results from the incorrect preciseness assumption.** The post then goes into exploitaiton, explaining how to take the register which is assumed to be 0 and leverage it to **overflow the stack, obtain arbitrary R/W, leak the eBPF map, and defeat KASLR.** They also include a **full** [**exploit PoC**](https://github.com/google/security-research/tree/master/pocs/linux/cve-2023-2163?ref=blog.exploits.club)**.**